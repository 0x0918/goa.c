# 希尔排序

1959 年一个叫 `Donald L. Shell (March 1, 1924 – November 2, 2015)` 的美国人在 ` Communications of the ACM 月刊` 发布了一个排序算法，从此名为希尔排序的算法诞生了。

希尔排序是直接插入排序的改进版本。因为直接插入排序对那些几乎已经排好序的数列来说，排序效率极高，达到了 `O(n)` 的线性复杂度，但是每次只能将数据移动一位。希尔排序创造性的可以将数据移动 `n` 位，然后将 `n` 一直缩小，缩到与直接插入排序一样为 `1`，请看下列分析。

## 一、算法介绍

有一个 `N` 个数的数列：

1. 先取一个小于 `N` 的整数 `d1`，将位置是 `d1` 整数倍的数们分成一组，对这些数进行直接插入排序。
2. 接着取一个小于 `d1` 的整数 `d2`，将位置是 `d2` 整数倍的数们分成一组，对这些数进行直接插入排序。
3. 接着取一个小于 `d2` 的整数 `d3`，将位置是 `d3` 整数倍的数们分成一组，对这些数进行直接插入排序。
4. ...
5. 直到取到的整数 `d=1`，接着使用直接插入排序。

这是一种分组插入方法，最后一次迭代就相当于是直接插入排序，其他迭代相当于每次移动 `n` 个距离的直接插入排序，这些整数是两个数之间的距离，我们称它们为增量。

一般取数列长度的一半为增量，以后每次减半，直到增量为1。

举个简单例子，希尔排序一个 12 个元素的数列：`[5 9 1 6 8 14 6 49 25 4 6 3]`，增量 `d` 的取值依次为：`6，3，1`：

```go
x 表示不需要排序的数


取 d = 6 对 [5 x x x x x 6 x x x x x] 进行直接插入排序，没有变化。
取 d = 3 对 [5 x x 6 x x 6 x x 4 x x] 进行直接插入排序，排完序后：[4 x x 5 x x 6 x x 6 x x]。
取 d = 1 对 [4 9 1 5 8 14 6 49 25 6 6 3] 进行直接插入排序，因为 d=1 完全就是直接插入排序了。
```

因为每一轮分组，都使用了直接插入排序，但分组会跨越 `n` 个位置，导致两个相同的数，发现不了对方而产生了顺序变化，所以希尔排序不是稳定的。

越有序的数列，直接插入排序的效率越高，希尔排序通过分组使用直接插入排序，因为步长比 `1` 大，在一开始可以很快将无序的数列变得不那么无序，比较和交换的次数也减少，直到最后使用步长为 `1` 的直接插入排序，数列已经是相对有序了，所以时间复杂度会稍好一点。

在最好情况下，也就是数列是有序时，使用希尔排序，需要进行 `logn` 次增量的直接插入排序，因为每次直接插入排序都是最佳的，时间复杂度为：`O(n)`，因此希尔排序的最佳时间复杂度为：`O(nlogn)`。

在其他情况下，因为数列的顺序是未知的，在数学求解下，无法确定明确的时间复杂度。


## 二、算法实现